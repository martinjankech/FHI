<html>

<head>
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
 <script src="https://code.highcharts.com/highcharts.js"></script>
 <script src="https://code.highcharts.com/highcharts.js"></script>
 <script src="https://code.highcharts.com/modules/data.js"></script>
 <script src="https://code.highcharts.com/modules/drilldown.js"></script>
 <script src="https://code.highcharts.com/modules/exporting.js"></script>
 <script src="https://code.highcharts.com/modules/export-data.js"></script>
 <script src="https://code.highcharts.com/modules/accessibility.js"></script>
</head>

<body>
 <div id="container" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
 <script>
  var data = {
   "AggregatedData": [
    {
     "Podkategoria": "sk",
     "TotalQuantity": 49,
     "TotalRevenue": 606.36,
     "Books": [
      {
       "Id": "1",
       "Name": "Harry Potter a Tajomná komnata",
       "TotalQuantity": 16,
       "TotalRevenue": 190.4
      },
      {
       "Id": "3",
       "Name": "Jednoduché účtovníctvo pre neziskovky",
       "TotalQuantity": 1,
       "TotalRevenue": 9.64
      },
      {
       "Id": "15",
       "Name": "Veľká štvorka",
       "TotalQuantity": 20,
       "TotalRevenue": 193.0
      },
      {
       "Id": "19",
       "Name": "Hotelík na Islande",
       "TotalQuantity": 8,
       "TotalRevenue": 113.36
      },
      {
       "Id": "29",
       "Name": "Návod na prežitie pre muža",
       "TotalQuantity": 4,
       "TotalRevenue": 99.96
      }
     ]
    },
    {
     "Podkategoria": "en",
     "TotalQuantity": 17,
     "TotalRevenue": 697.0,
     "Books": [
      {
       "Id": "9",
       "Name": "Hacking Web Apps",
       "TotalQuantity": 17,
       "TotalRevenue": 697.0
      }
     ]
    },
    {
     "Podkategoria": "cz",
     "TotalQuantity": 3,
     "TotalRevenue": 49.08,
     "Books": [
      {
       "Id": "27",
       "Name": "Mimo dobro a zlo",
       "TotalQuantity": 3,
       "TotalRevenue": 49.08
      }
     ]
    }
   ],
   "TotalAggregatedData": {
    "TotalQuantity": 69,
    "TotalRevenue": 1352.44
   }
  };

  var podkategoriaData = [];
  data.AggregatedData.forEach(function (podkategoria) {
   podkategoriaData.push({
    name: podkategoria.Podkategoria,
    y: podkategoria.TotalRevenue,
    drilldown: podkategoria.Podkategoria
   });
  });
  console.log(podkategoriaData)


  var bookData = [];
  data.AggregatedData.forEach(function (podkategoria) {
   var books = [];
   podkategoria.Books.forEach(function (book) {
    books.push([book.Name, book.TotalRevenue]);
   });
   bookData.push({
    //name: podkategoria.Podkategoria,
    id: podkategoria.Podkategoria,
    data: books
   });
  });
  console.log(bookData)

  // Create the chart
  Highcharts.chart('container', {
   chart: {
    type: 'column'
   },
   title: {
    text: 'Total Revenue by Podkategoria and Book'
   },
   xAxis: {
    type: 'category'
   },
   yAxis: {
    title: {
     text: 'Total Revenue'
    }
   },
   legend: {
    enabled: false
   },
   plotOptions: {
    series: {
     borderWidth: 0,
     dataLabels: {
      enabled: true,
      format: '${point.y:.2f}'
     }
    }
   },
   tooltip: {
    headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
    pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>${point.y:.2f}</b><br/>'
   },
   series: [{
    name: 'Podkategoria',
    colorByPoint: true,
    data: podkategoriaData
   }],
   drilldown: {
    series: bookData
   }
  });
 </script>
</body>

</html>